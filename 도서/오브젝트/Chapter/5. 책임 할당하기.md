
# ğŸ¤¡ ì±…ì„ ì£¼ë„ ì„¤ê³„ë¥¼ í–¥í•´
> ë°ì´í„° ì¤‘ì‹¬ì˜ ì„¤ê³„ì—ì„œ ì±…ì„ ì¤‘ì‹¬ì˜ ì„¤ê³„ë¡œ ì „í™˜í•˜ê¸° ìœ„í•´ì„œëŠ” ë‘ ê°€ì§€ ì›ì¹™ì„ ë”°ë¼ì•¼ í•œë‹¤.

- ë°ì´í„°ë³´ë‹¤ í–‰ë™ì„ ë¨¼ì € ê²°ì •í•˜ë¼
- í˜‘ë ¥ì´ë¼ëŠ” ë¬¸ë§¥ ì•ˆì—ì„œ ì±…ì„ì„ ê²°ì •í•˜ë¼

## ë°ì´í„°ë³´ë‹¤ í–‰ë™ì„ ë¨¼ì € ê²°ì •í•˜ë¼
- ê°ì²´ëŠ” í˜‘ë ¥ì— ì°¸ì—¬í•˜ê¸° ìœ„í•´ ì¡´ì¬í•˜ë©° í˜‘ë ¥ ì•ˆì—ì„œ ìˆ˜í–‰í•˜ëŠ” ì±…ì„ì´ ê³§ ê°ì²´ì˜ ì¡´ì¬ ê°€ì¹˜ë¥¼ ì¦ëª…í•œë‹¤.
- ë°ì´í„°ì— ì´ˆì ì„ ë§ì¶”ê²Œ ë˜ë©´ ê°ì²´ì˜ ìº¡ìŠí™”ê°€ ì•½í™”ë˜ê¸° ë•Œë¬¸ì— ë‚®ì€ ì‘ì§‘ë„ì™€ ë†’ì€ ê²°í•©ë„ë¥¼ ê°€ì§„ ê°ì²´ë“¤ë¡œ ë„˜ì³ë‚˜ê²Œ ëœë‹¤.
- *ê°ì²´ì˜ í–‰ë™* ì¦‰, ì±…ì„ì„ ë¨¼ì € ê²°ì •í•œ í›„ì— ê°ì²´ì˜ ìƒíƒœë¥¼ ê²°ì •í•œë‹¤.

## í˜‘ë ¥ì´ë¼ëŠ” ë¬¸ë§¥ ì•ˆì—ì„œ ì±…ì„ì„ ê²°ì •í•˜ë¼
- ë©”ì„¸ì§€ë¥¼ ê²°ì •í•œ í›„ì— ê°ì²´ë¥¼ ì„ íƒí•´ì•¼ í˜‘ë ¥ì— ì í•©í•œ ì±…ì„ì„ ìˆ˜í™•í•  ìˆ˜ ìˆë‹¤.
- ê°ì²´ê°€ ë©”ì„¸ì§€ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë©”ì„¸ì§€ê°€ ê°ì²´ë¥¼ ì„ íƒí•˜ê²Œ í•´ì•¼í•œë‹¤.
- ë©”ì„¸ì§€ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ì˜ë„ë¥¼ í‘œí˜„í•œë‹¤.


## ì±…ì„ ì£¼ë„ ì„¤ê³„
- ì‹œìŠ¤í…œì´ ì‚¬ìš©ìì—ê²Œ ì œê³µí•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì¸ ì‹œìŠ¤í…œ ì±…ì„ì„ íŒŒì•…í•œë‹¤.
- ì‹œìŠ¤í…œ ì±…ì„ì„ ë” ì‘ì€ ì±…ì„ìœ¼ë¡œ ë¶„í• í•œë‹¤.
- ë¶„í• ëœ ì±…ì„ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì ì ˆí•œ ê°ì²´ ë˜ëŠ” ì—­í• ì„ ì°¾ì•„ ì±…ì„ì„ í• ë‹¹í•œë‹¤.
- ê°ì²´ê°€ ì±…ì„ì„ ìˆ˜í–‰í•˜ëŠ” ë„ì¤‘ ë‹¤ë¥¸ ê°ì²´ì˜ ë„ì›€ì´ í•„ìš”í•œ ê²½ìš° ì´ë¥¼ ì±…ì„ì§ˆ ì ì ˆí•œ ê°ì²´ ë˜ëŠ” ì—­í• ì„ ê°–ëŠ”ë‹¤.
- í•´ë‹¹ ê°ì²´ ë˜ëŠ” ì—­í• ì—ê²Œ ì±…ì„ì„ í• ë‹¹í•¨ìœ¼ë¡œì¨ ë‘ ê°ì²´ê°€ í˜‘ë ¥í•˜ê²Œ í•œë‹¤.


# ğŸ­ ì±…ì„ í• ë‹¹ì„ ìœ„í•œ GRASP íŒ¨í„´
> *GRASP íŒ¨í„´* : ê°ì²´ì—ê²Œ ì±…ì„ì„ í• ë‹¹í•  ë•Œ ì§€ì¹¨ìœ¼ë¡œ ì‚¼ì„ ìˆ˜ ìˆëŠ” ì›ì¹™ë“¤ì˜ ì§‘í•©

#ê°ì²´ì§€í–¥/GRASPíŒ¨í„´-ì±…ì„í• ë‹¹ì›ì¹™
## ë„ë©”ì¸ ê°œë…ì—ì„œ ì¶œë°œí•˜ê¸°
- ë„ë©”ì¸ ê°œë…ë“¤ì„ ì±…ì„ í• ë‹¹ì˜ ëŒ€ìƒìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ì½”ë“œì— ë„ë©”ì¸ì˜ ëª¨ìŠµì„ íˆ¬ì˜í•˜ê¸°ê°€ ì¢€ ë” ìˆ˜ì›”í•´ì§„ë‹¤.
- ë‹¨, ë„ë©”ì¸ì˜ ê°œë…ì„ ì •ë¦¬í•˜ëŠ” ë°ì— ë„ˆë¬´ ë§ì€ ì‹œê°„ì„ ë“¤ì´ì§€ ë§ê³  ë¹ ë¥´ê²Œ ì„¤ê³„ì™€ êµ¬í˜„ì„ ì§„í–‰í•˜ë¼.

## ì •ë³´ ì „ë¬¸ê°€ì—ê²Œ ì±…ì„ì„ í• ë‹¹í•˜ë¼
> ì •ë³´ ì „ë¬¸ê°€ íŒ¨í„´(INFORMATION EXPERT) íŒ¨í„´ : ì±…ì„ì„ ìˆ˜í–‰í•  ì •ë³´ë¥¼ ì•Œê³  ìˆëŠ” ê°ì²´ì—ê²Œ ì±…ì„ì„ í• ë‹¹í•˜ëŠ” ê²ƒ.

1. ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•  ê°ì²´ëŠ” ë¬´ì—‡ì„ ì›í•˜ëŠ”ê°€?
2. ë©”ì„¸ì§€ë¥¼ ìˆ˜ì‹ í•  ì í•©í•œ ê°ì²´ëŠ” ëˆ„êµ¬ì¸ê°€?

## ë†’ì€ ì‘ì§‘ë„ì™€ ë‚®ì€ ê²°í•©ë„
> GRASPì—ì„œ LOW COUPLING(ë‚®ì€ ê²°í•©ë„) íŒ¨í„´ê³¼ HIGH COHESION(ë†’ì€ ì‘ì§‘ë„) íŒ¨í„´

- LOW COUPLING(ë‚®ì€ ê²°í•©ë„) íŒ¨í„´
	- ì–´ë–»ê²Œ í•˜ë©´ ì˜ì¡´ì„±ì„ ë‚®ì¶”ê³  ë³€í™”ì˜ ì˜í–¥ì„ ì¤„ì´ë©° ì¬ì‚¬ìš©ì„±ì„ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆì„ê¹Œ?
	- ì„¤ê³„ì˜ ì „ì²´ì ì¸ ê²°í•©ë„ê°€ ë‚®ê²Œ ìœ ì§€ë˜ë„ë¡ ì±…ì„ì„ í• ë‹¹í•˜ë¼.
- HIGH COHESION(ë†’ì€ ì‘ì§‘ë„) íŒ¨í„´
	- ì–´ë–»ê²Œ ë³µì¡ì„±ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ìœ¼ë¡œ ìœ ì§€í•  ê²ƒì¸ê°€?
	- ë†’ì€ ì‘ì§‘ë„ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆê²Œ ì±…ì„ì„ í• ë‹¹í•˜ë¼.

## ì°½ì¡°ìì—ê²Œ ê°ì²´ ìƒì„± ì±…ì„ì„ í• ë‹¹í•˜ë¼
- CREATOR íŒ¨í„´(ì°½ì¡°ì íŒ¨í„´) : ê°ì²´ Aë¥¼ ìƒì„±í•´ì•¼ í•  ë•Œ ì–´ë–¤ ê°ì²´ì—ê²Œ ê°ì²´ ìƒì„± íŒ¨í„´ì„ í• ë‹¹í•´ì•¼ í•˜ëŠ”ê°€? 

> ì•„ë˜ ì¡°ê±´ì„ ìµœëŒ€í•œ ë§ì´ ë§Œì¡±í•˜ëŠ” Bì—ê²Œ ê°ì²´ ìƒì„± ì±…ì„ì„ í• ë‹¹í•˜ë¼.

- Bê°€ A ê°ì²´ë¥¼ í¬í•¨í•˜ê±°ë‚˜ ì°¸ì¡°í•œë‹¤.
- Bê°€ A ê°ì²´ë¥¼ ê¸°ë¡í•œë‹¤.
- Bê°€ A ê°ì²´ë¥¼ ê¸´ë°€í•˜ê²Œ ì‚¬ìš©í•œë‹¤.
- Bê°€ A ê°ì²´ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ë° í•„ìš”í•œ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.(ì´ ê²½ìš° BëŠ” Aì— ëŒ€í•œ ì •ë³´ ì „ë¬¸ê°€ë‹¤.)


# ğŸ£ êµ¬í˜„ì„ í†µí•œ ê²€ì¦

```typescript title="ì˜ˆì œì½”ë“œ1"
class Customer {
  constructor(
    private _id: string,
    private _name: string,
    private _age: number
  ) {}
}

class Money {
  static readonly ZERO = Money.wons(0);

  constructor(private amount: number) {}

  static wons(amount: number) {
    return new Money(amount);
  }

  getAmount(): number {
    return this.amount;
  }

  plus = (amount: number): Money => {
    return new Money(this.amount + amount);
  };

  minus = (amount: number): Money => {
    return new Money(this.amount - amount);
  };

  times = (percent: number): Money => {
    return new Money(this.amount * percent);
  };

  isLessThan = (other: Money): boolean => {
    return this.amount < other.getAmount();
  };

  isGreaterThanOrEqual = (other: Money): boolean => {
    return this.amount >= other.getAmount();
  };
}

class Screening {
  constructor(
    private movie: Movie,
    private sequence: number,
    private whenScreened: Date
  ) {}

  getWhenScreened = (): Date => {
    return this.whenScreened;
  };

  getSequence = (): number => {
    return this.sequence;
  };

  private calculateFee = (audienceCount: number): Money => {
    return this.movie.calculateMovieFee(this).times(audienceCount);
  };

  reserve = (customer: Customer, audienceCount: number): Reservation => {
    return new Reservation(
      customer,
      this,
      this.calculateFee(audienceCount),
      audienceCount
    );
  };
}

enum MovieType {
  AMOUNT_DISCOUNT = "AMOUNT_DISCOUNT",
  PERCENT_DISCOUNT = "PERCENT_DISCOUNT",
  NONE_DISCOUNT = "NONE_DISCOUNT",
}

class Movie {
  constructor(
    private title: string,
    private runningTime: number,
    private fee: Money,
    private discountConditions: Array<DiscountCondition>,
    //
    private movieType: MovieType,
    private discountAmount: Money,
    private discountPercent: number
  ) {}

  calculateMovieFee = (screening: Screening): Money => {
    if (this.isDiscountable(screening)) {
      return this.fee.minus(this.calculateDiscountAmount().getAmount());
    }

    return this.fee;
  };

  private isDiscountable = (screening: Screening): boolean => {
    return this.discountConditions.some((condition) =>
      condition.isSatisfiedBy(screening)
    );
  };

  private calculateDiscountAmount = (): Money | never => {
    switch (this.movieType) {
      case "AMOUNT_DISCOUNT":
        return this.calculateAmountDiscountAmount();
      case "PERCENT_DISCOUNT":
        return this.calculatePercentDiscountAmount();
      case "NONE_DISCOUNT":
        return this.calculateNoneDiscountAmount();
    }

    throw new Error("ERROR");
  };

  private calculateAmountDiscountAmount = (): Money => {
    return this.discountAmount;
  };

  private calculatePercentDiscountAmount = (): Money => {
    return this.fee.times(this.discountPercent);
  };

  private calculateNoneDiscountAmount = (): Money => {
    return Money.ZERO;
  };
}

enum DiscountConditionType {
  SEQUENCE = "SEQUENCE",
  PERIOD = "PERIOD",
}

class DiscountCondition {
  constructor(
    private type: DiscountConditionType,
    private sequence: number,
    private dayOfWeek: number,
    private startTime: number,
    private endTime: number
  ) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    if (this.type === DiscountConditionType.PERIOD) {
      return this.isSatisfiedByPeriod(screening);
    }

    return this.isSatisfiedBySequence(screening);
  };

  private isSatisfiedByPeriod = (screening: Screening): boolean => {
    return (
      this.dayOfWeek === screening.getWhenScreened().getDay() &&
      this.startTime <= screening.getWhenScreened().getTime() &&
      this.endTime >= screening.getWhenScreened().getTime()
    );
  };

  private isSatisfiedBySequence = (screening: Screening): boolean => {
    return this.sequence === screening.getSequence();
  };
}

class Reservation {
  constructor(
    private customer: Customer,
    private screening: Screening,
    private fee: Money,
    private audienceCount: number
  ) {}
}
```

## DiscountCondition ê°œì„ í•˜ê¸°
```typescript title="DiscountCondition"
class DiscountCondition {
  constructor(
    private type: DiscountConditionType,
    private sequence: number,
    private dayOfWeek: number,
    private startTime: number,
    private endTime: number
  ) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    if (this.type === DiscountConditionType.PERIOD) {
      return this.isSatisfiedByPeriod(screening);
    }

    return this.isSatisfiedBySequence(screening);
  };

  private isSatisfiedByPeriod = (screening: Screening): boolean => {
    return (
      this.dayOfWeek === screening.getWhenScreened().getDay() &&
      this.startTime <= screening.getWhenScreened().getTime() &&
      this.endTime >= screening.getWhenScreened().getTime()
    );
  };

  private isSatisfiedBySequence = (screening: Screening): boolean => {
    return this.sequence === screening.getSequence();
  };
}
```

> DiscountConditionì´ ë³€ê²½ì— ì·¨ì•½í•œ í´ë˜ìŠ¤ì¸ ì´ìœ 

- ìƒˆë¡œìš´ í• ì¸ ì¡°ê±´ ì¶”ê°€
- ìˆœë²ˆ ì¡°ê±´ì„ íŒë‹¨í•˜ëŠ” ë¡œì§ ë³€ê²½
- ê¸°ê°„ ì¡°ê±´ì„ íŒë‹¨í•˜ëŠ” ë¡œì§ì´ ë³€ê²½ë˜ëŠ” ê²½ìš°
### í´ë˜ìŠ¤ ì‘ì§‘ë„ íŒë‹¨í•˜ê¸°
> ì‘ì§‘ë„ê°€ ë‚®ë‹¤ëŠ” ê²ƒì€ ì„œë¡œ ì—°ê´€ì„±ì´ ì—†ëŠ” ê¸°ëŠ¥ì´ë‚˜ ë°ì´í„°ê°€ í•˜ë‚˜ì˜í´ë˜ìŠ¤ ì•ˆì— ë­‰ì³ì ¸ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

1. í´ë˜ìŠ¤ê°€í•˜ë‚˜ ì´ìƒì˜ ì´ìœ ë¡œ ë³€ê²½ ë¼ì•¼ í•œë‹¤ë©´ ì‘ì§‘ë„ê°€ ë‚®ì€ ê²ƒì´ë‹¤. 
2. ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ê°€ ì´ˆê¸°í™” ë˜ëŠ” ì‹œì 
	- ì‘ì§‘ë„ê°€ ë†’ì€ í´ë˜ìŠ¤ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ëª¨ë“  ì†ì„±ì„ í•¨ê»˜ ì´ˆê¸°í™”í•œë‹¤.
	- ì‘ì§‘ë„ê°€ ë‚®ì€ í´ë˜ìŠ¤ëŠ” ê°ì²´ì˜ ì†ì„± ì¤‘ ì¼ë¶€ë§Œ ì´ˆê¸°í™” í•˜ê³  ì¼ë¶€ëŠ” ì´ˆê¸°í™”ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ë‚¨ê²¨ì§„ë‹¤.
3. ë©”ì„œë“œë“¤ì´ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
	- ëª¨ë“  ë©”ì„œë“œê°€ ê°ì²´ì˜ ëª¨ë“  ì†ì„±ì„ ì‚¬ìš©í•œë‹¤ë©´ í´ë˜ìŠ¤ì˜ ì‘ì§‘ë„ëŠ” ë†’ë‹¤.
	- ë©”ì„œë“œë“¤ì´ ì‚¬ìš©í•˜ëŠ” ì†ì„±ì— ë”°ë¼ ê·¸ë£¹ì´ ë‚˜ë‰œë‹¤ë©´ ì‘ì§‘ë„ê°€ ë‚®ë‹¤.

#### ì‘ì§‘ë„ê°€ ë†’ì€ í´ë˜ìŠ¤ë¥¼ ë§Œë“œë ¤ë©´
- *ë³€ê²½ì˜ ì´ìœ ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ ë¶„ë¦¬í•˜ë¼* 
- *í•¨ê»˜ ì´ˆê¸°í™”ë˜ëŠ” ì†ì„±ì„ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.* 
- *ì†ì„± ê·¸ë£¹ê³¼ í•´ë‹¹ ê·¸ë£¹ì— ì ‘ê·¼í•˜ëŠ” ë©”ì„œë“œ ê·¸ë£¹ì„ ê¸°ì¤€ìœ¼ë¡œ ì½”ë“œë¥¼ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.* 




## íƒ€ì… ë¶„ë¦¬í•˜ê¸°
```typescript title="ì˜ˆì œì½”ë“œ2"
class Customer {
  constructor(
    private _id: string,
    private _name: string,
    private _age: number
  ) {}
}

class Money {
  static readonly ZERO = Money.wons(0);

  constructor(private amount: number) {}

  static wons(amount: number) {
    return new Money(amount);
  }

  getAmount(): number {
    return this.amount;
  }

  plus = (amount: number): Money => {
    return new Money(this.amount + amount);
  };

  minus = (amount: number): Money => {
    return new Money(this.amount - amount);
  };

  times = (percent: number): Money => {
    return new Money(this.amount * percent);
  };

  isLessThan = (other: Money): boolean => {
    return this.amount < other.getAmount();
  };

  isGreaterThanOrEqual = (other: Money): boolean => {
    return this.amount >= other.getAmount();
  };
}

class Screening {
  constructor(
    private movie: Movie,
    private sequence: number,
    private whenScreened: Date
  ) {}

  getWhenScreened = () => {
    return this.whenScreened;
  };

  getSequence = () => {
    return this.sequence;
  };

  private calculateFee = (audienceCount: number): Money => {
    return this.movie.calculateMovieFee(this).times(audienceCount);
  };

  reserve = (customer: Customer, audienceCount: number): Reservation => {
    return new Reservation(
      customer,
      this,
      this.calculateFee(audienceCount),
      audienceCount
    );
  };
}

enum MovieType {
  AMOUNT_DISCOUNT = "AMOUNT_DISCOUNT",
  PERCENT_DISCOUNT = "PERCENT_DISCOUNT",
  NONE_DISCOUNT = "NONE_DISCOUNT",
}

class Movie {
  constructor(
    private title: string,
    private runningTime: number,
    private fee: Money,
    private discountConditions: Array<DiscountCondition>,

    private movieType: MovieType,
    private discountAmount: Money,
    private discountPercent: number
  ) {}

  calculateMovieFee = (screening: Screening): Money => {
    if (this.isDiscountable(screening)) {
      return this.fee.minus(this.calculateDiscountAmount().getAmount());
    }

    return this.fee;
  };

  private isDiscountable = (screening: Screening): boolean => {
    return this.discountConditions.some((condition) =>
      condition.isSatisfiedBy(screening)
    );
  };

  private calculateDiscountAmount = (): Money | never => {
    switch (this.movieType) {
      case "AMOUNT_DISCOUNT":
        return this.calculateAmountDiscountAmount();
      case "PERCENT_DISCOUNT":
        return this.calculatePercentDiscountAmount();
      case "NONE_DISCOUNT":
        return this.calculateNoneDiscountAmount();
    }

    throw new Error("ERROR");
  };

  private calculateAmountDiscountAmount = (): Money => {
    return this.discountAmount;
  };

  private calculatePercentDiscountAmount = (): Money => {
    return this.fee.times(this.discountPercent);
  };

  private calculateNoneDiscountAmount = (): Money => {
    return Money.ZERO;
  };
}

enum DiscountConditionType {
  SEQUENCE = "SEQUENCE",
  PERIOD = "PERIOD",
}

interface DiscountCondition {
  isSatisfiedBy: (screening: Screening) => boolean;
}

class PeriodCondition implements DiscountCondition {
  constructor(
    private dayOfWeek: number,
    private startTime: number,
    private endTime: number
  ) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    return (
      this.dayOfWeek === screening.getWhenScreened().getDay() &&
      this.startTime <= screening.getWhenScreened().getTime() &&
      this.endTime >= screening.getWhenScreened().getTime()
    );
  };
}

class SequenceCondtion implements DiscountCondition {
  constructor(private sequence: number) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    return this.sequence === screening.getSequence();
  };
}

class Reservation {
  constructor(
    private customer: Customer,
    private screening: Screening,
    private fee: Money,
    private audienceCount: number
  ) {}
}
```


> SequenceConditionê³¼ PeriodConditionì´ë¼ëŠ” ë‘ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬

```typescript
class PeriodCondition {
  constructor(
    private dayOfWeek: number,
    private startTime: number,
    private endTime: number
  ) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    return (
      this.dayOfWeek === screening.getWhenScreened().getDay() &&
      this.startTime <= screening.getWhenScreened().getTime() &&
      this.endTime >= screening.getWhenScreened().getTime()
    );
  };
}

class SequenceCondtion {
  constructor(private sequence: number) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    return this.sequence === screening.getSequence();
  };
}
```

> í´ë˜ìŠ¤ë¥¼ ë¶„ë¦¬í•œ í›„ ìƒˆë¡œìš´ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.
> Movie ì¸ìŠ¤í„´ìŠ¤ëŠ” ì´ì œëŠ” PeriodConditioní´ë˜ìŠ¤ì™€ SequenceCondtion í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì™€ í˜‘ë ¥í•  ìˆ˜ ìˆì–´ì•¼í•œë‹¤.

## ë‹¤í˜•ì„±ì„ í†µí•´ ë¶„ë¦¬í•˜ê¸°
> MovieëŠ” í• ì¸ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ë°˜í™˜ í•´ì£¼ê¸°ë§Œ í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ì´ë•Œ *ì—­í• * ì˜ ê°œë…ì´ ì‚¬ìš© ëœë‹¤.
> ì¶”ìƒ í´ë˜ìŠ¤ë‚˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.

```typescript
interface DiscountCondition {
    isSatisfiedBy: (screening: Screening) => boolean;
  }

  class PeriodCondition implements DiscountCondition {
    constructor(
      private dayOfWeek: number,
      private startTime: number,
      private endTime: number
    ) {}

    isSatisfiedBy = (screening: Screening): boolean => {
      return (
        this.dayOfWeek === screening.getWhenScreened().getDay() &&
        this.startTime <= screening.getWhenScreened().getTime() &&
        this.endTime >= screening.getWhenScreened().getTime()
      );
    };
  }

  class SequenceCondtion implements DiscountCondition {
    constructor(private sequence: number) {}

    isSatisfiedBy = (screening: Screening): boolean => {
      return this.sequence === screening.getSequence();
    };
  }

class Movie {

	private discountConditions: Array<DiscountCondition>,
	constructor() {}
	
	calculateMovieFee = (screening: Screening): Money => {
	if (this.isDiscountable(screening)) {
		return this.fee.minus(this.calculateDiscountAmount().getAmount());
	}
	
		return this.fee;
	};

  private isDiscountable = (screening: Screening): boolean => {
	return this.discountConditions.some((condition) =>
	  condition.isSatisfiedBy(screening)
	);
  };
}
```

- GRASPì—ì„œ POLYMORPHISM(ë‹¤í˜•ì„±) íŒ¨í„´ : ê°ì²´ì˜ íƒ€ì…ì— ë”°ë¼ ë³€í•˜ëŠ” í–‰ë™ì´ ìˆë‹¤ë©´ íƒ€ì…ì„ ë¶„ë¦¬í•˜ê³  ë³€í™”í•˜ëŠ” í–‰ë™ì„ ê° íƒ€ì…ì˜ ì±…ì„ìœ¼ë¡œ í• ë‹¹í•˜ë¼ëŠ”ê²ƒ.

> POLYMORPHISM(ë‹¤í˜•ì„±)íŒ¨í„´
> ê°ì²´ì˜ íƒ€ì…ì— ë”°ë¼ ë³€í•˜ëŠ” ë¡œì§ì´ ìˆì„ ë•Œ ë³€í•˜ëŠ” ë¡œì§ì„ ë‹´ë‹¹í•  ì±…ì„ì„ ì–´ë–»ê²Œ í• ë‹¹í•´ì•¼ í•˜ëŠ”ê°€? 
> íƒ€ì…ì„ ëª…ì‹œì ìœ¼ë¡œ ì •ì˜í•˜ê³  ê° íƒ€ì…ì— ë‹¤í˜•ì ìœ¼ë¡œ í–‰ë™í•˜ëŠ” ì±…ì„ì„ í• ë‹¹í•˜ë¼.
> í”„ë¡œê·¸ë¨ì„ if ~ else ë˜ëŠ” switch ~ case ë“±ì˜ ì¡°ê±´ ë…¼ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ ì„¤ê³„ í•œë‹¤ë©´ ìƒˆë¡œìš´ ë³€í™”ê°€ ì¼ì–´ë‚œ ê²½ìš°
> ì¡°ê±´ ë…¼ë¦¬ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤. 
> POLYMORPHISM íŒ¨í„´ì€ ê°ì²´ì˜ íƒ€ì…ì„ ê²€ì‚¬í•´ì„œ íƒ€ì…ì— ë”°ë¼ ì—¬ëŸ¬ ëŒ€ì•ˆë“¤ì„ ìˆ˜í–‰í•˜ëŠ” ì¡°ê±´ì ì¸ ë…¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ë¼ê³  ê²½ê³ í•œë‹¤. 
> **ë‹¤í˜•ì„±ì„ ì´ìš©í•´ ìƒˆë¡œìš´ ë³€í™”ë¥¼ ë‹¤ë£¨ê¸°ì‰½ê²Œ í™•ì¥í•˜ë¼ê³  ê¶Œê³ í•œë‹¤.** 

## ë³€ê²½ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ê¸°
### PROTECTED VARIATIONS(ë³€ê²½ ë³´í˜¸) íŒ¨í„´
- ê°ì²´, ì„œë¸Œì‹œìŠ¤í…œ, ì‹œìŠ¤í…œì„ ì–´ë–»ê²Œ ì„¤ê³„í•´ì•¼ ë³€í™”ì™€ ë¶ˆì•ˆì •ì„±ì´ ë‹¤ë¥¸ ìš”ì†Œì— ë‚˜ìœ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ ë°©ì§€í•  ìˆ˜ ìˆì„ê¹Œ?
- ë³€í™”ê°€ ì˜ˆìƒë˜ëŠ” ë¶ˆì•ˆì •í•œ ì§€ì ë“¤ì„ ì‹ë³„í•˜ê³  ê·¸ ì£¼ìœ„ì— ì•ˆì •ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜•ì„±í•˜ë„ë¡ ì±…ì„ì„ í• ë‹¹í•˜ë¼.
- *ì„¤ê³„ì—ì„œ ë³€í•˜ëŠ” ê²ƒì´ ë¬´ì—‡ì¸ì§€ ê³ ë ¤í•˜ê³  ë³€í•˜ëŠ” ê°œë…ì„ ìº¡ìŠí™”í•˜ë¼* 



## Movie í´ë˜ìŠ¤ ê°œì„ í•˜ê¸°
```typescript title="ì˜ˆì œì½”ë“œ3"
class Customer {
  constructor(
    private _id: string,
    private _name: string,
    private _age: number
  ) {}
}

class Money {
  static readonly ZERO = Money.wons(0);

  constructor(private amount: number) {}

  static wons(amount: number) {
    return new Money(amount);
  }

  getAmount(): number {
    return this.amount;
  }

  plus = (amount: number): Money => {
    return new Money(this.amount + amount);
  };

  minus = (amount: number): Money => {
    return new Money(this.amount - amount);
  };

  times = (percent: number): Money => {
    return new Money(this.amount * percent);
  };

  isLessThan = (other: Money): boolean => {
    return this.amount < other.getAmount();
  };

  isGreaterThanOrEqual = (other: Money): boolean => {
    return this.amount >= other.getAmount();
  };
}

class Screening {
  constructor(
    private movie: Movie,
    private sequence: number,
    private whenScreened: Date
  ) {}

  getWhenScreened = () => {
    return this.whenScreened;
  };

  getSequence = () => {
    return this.sequence;
  };

  private calculateFee = (audienceCount: number): Money => {
    return this.movie.calculateMovieFee(this).times(audienceCount);
  };
}

enum MovieType {
  AMOUNT_DISCOUNT = "AMOUNT_DISCOUNT",
  PERCENT_DISCOUNT = "PERCENT_DISCOUNT",
  NONE_DISCOUNT = "NONE_DISCOUNT",
}

abstract class Movie {
  constructor(
    private title: string,
    private runningTime: number,
    private fee: Money,
    private discountConditions: Array<DiscountCondition>
  ) {}

  protected getFee(): Money {
    return this.fee;
  }

  public calculateMovieFee(screening: Screening): Money {
    if (this.isDiscountable(screening)) {
      return this.fee.minus(this.calculateDiscountAmount().getAmount());
    }

    return this.fee;
  }

  private isDiscountable(screening: Screening): boolean {
    return this.discountConditions.some((condition) =>
      condition.isSatisfiedBy(screening)
    );
  }

  protected abstract calculateDiscountAmount(): Money;
}

class AmountDiscountMoive extends Movie {
  private discountAmount: Money;

  constructor(
    title: string,
    runningTime: number,
    fee: Money,
    discountConditions: Array<DiscountCondition>,
    discountAmount: Money
  ) {
    super(title, runningTime, fee, discountConditions);
    this.discountAmount = discountAmount;
  }

  protected override calculateDiscountAmount(): Money {
    return this.discountAmount;
  }
}

class PercentDiscountMovie extends Movie {

  private percent: number;

  constructor(
    title: string,
    runningTime: number,
    fee: Money,
    discountConditions: Array<DiscountCondition>,
    percent: number
  ) {
    super(title, runningTime, fee, discountConditions);
    this.percent = percent;
  }

  protected override calculateDiscountAmount(): Money {
    return this.getFee().times(this.percent);
  }
  
}

class NoneDiscountMovie extends Movie {
  constructor(
    title: string,
    runningTime: number,
    fee: Money,
    discountConditions: Array<DiscountCondition>
  ) {
    super(title, runningTime, fee, discountConditions);
  }

  protected override calculateDiscountAmount(): Money {
    return Money.ZERO;
  }
}

enum DiscountConditionType {
  SEQUENCE = "SEQUENCE",
  PERIOD = "PERIOD",
}

interface DiscountCondition {
  isSatisfiedBy: (screening: Screening) => boolean;
}

class PeriodCondition implements DiscountCondition {
  constructor(
    private dayOfWeek: number,
    private startTime: number,
    private endTime: number
  ) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    return (
      this.dayOfWeek === screening.getWhenScreened().getDay() &&
      this.startTime <= screening.getWhenScreened().getTime() &&
      this.endTime >= screening.getWhenScreened().getTime()
    );
  };
}

class SequenceCondtion implements DiscountCondition {
  constructor(private sequence: number) {}

  isSatisfiedBy = (screening: Screening): boolean => {
    return this.sequence === screening.getSequence();
  };
}

class Reservation {
  constructor() {}
}
```

***

```typescript
abstract class Movie {
  constructor(
    private title: string,
    private runningTime: number,
    private fee: Money,
    private discountConditions: Array<DiscountCondition>
  ) {}

  protected getFee(): Money {
    return this.fee;
  }

  public calculateMovieFee(screening: Screening): Money {
    if (this.isDiscountable(screening)) {
      return this.fee.minus(this.calculateDiscountAmount().getAmount());
    }

    return this.fee;
  }

  private isDiscountable(screening: Screening): boolean {
    return this.discountConditions.some((condition) =>
      condition.isSatisfiedBy(screening)
    );
  }

  protected abstract calculateDiscountAmount(): Money;
}

class AmountDiscountMoive extends Movie {
  private discountAmount: Money;

  constructor(
    title: string,
    runningTime: number,
    fee: Money,
    discountConditions: Array<DiscountCondition>,
    discountAmount: Money
  ) {
    super(title, runningTime, fee, discountConditions);
    this.discountAmount = discountAmount;
  }

  protected override calculateDiscountAmount(): Money {
    return this.discountAmount;
  }
}

class PercentDiscountMovie extends Movie {

  private percent: number;

  constructor(
    title: string,
    runningTime: number,
    fee: Money,
    discountConditions: Array<DiscountCondition>,
    percent: number
  ) {
    super(title, runningTime, fee, discountConditions);
    this.percent = percent;
  }

  protected override calculateDiscountAmount(): Money {
    return this.getFee().times(this.percent);
  }
  
}

class NoneDiscountMovie extends Movie {
  constructor(
    title: string,
    runningTime: number,
    fee: Money,
    discountConditions: Array<DiscountCondition>
  ) {
    super(title, runningTime, fee, discountConditions);
  }

  protected override calculateDiscountAmount(): Money {
    return Money.ZERO;
  }
}
```

## ë³€ê²½ê³¼ ìœ ì—°ì„±
> ê°œë°œìë¡œì„œ ë³€ê²½ì— ëŒ€ë¹„í•  ìˆ˜ ìˆëŠ”ê²ƒ

1. ì½”ë“œë¥¼ ì´í•´í•˜ê³  ìˆ˜ì •í•˜ê¸° ì‰½ë„ë¡ ìµœëŒ€í•œ ë‹¨ìˆœí•˜ê²Œ ì„¤ê³„í•˜ëŠ” ê²ƒì´ë‹¤.
2. ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³ ë„ ë³€ê²½ì„ ìˆ˜ìš©í•  ìˆ˜ ìˆë„ë¡ ì½”ë“œë¥¼ ë” ìœ ì—°í•˜ê²Œ ë§Œë“œëŠ” ê²ƒ.

> ê°ì²´ì§€í–¥ì—ì„œ ì±…ì„ í• ë‹¹í•˜ëŠ” ë° ì–´ë ¤ì›€ì„ ëŠë¼ê³  ìˆë‹¤ë©´ ì¼ë‹¨ ì ˆì°¨í˜• ì½”ë“œë¡œ ì‹¤í–‰ë˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë¹ ë¥´ê²Œ ì‘ì„±í•œ í›„ ì™„ì„±ëœ ì½”ë“œë¥¼ ê°ì²´ì§€í–¥ì ì¸ ì½”ë“œë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ë‹¤.

# ğŸ¸ ì±…ì„ ì£¼ë„ ì„¤ê³„ì˜ ëŒ€ì•ˆ
- *ë¦¬íŒ©í„°ë§(Refactoring)* : ìº¡ìŠí™”ë¥¼ í–¥ìƒ ì‹œí‚¤ê³ , ì‘ì§‘ë„ë¥¼ ë†’ì´ê³ , ê²°í•©ë„ë¥¼ ë‚®ì¶°ì•¼ í•˜ì§€ë§Œ ë™ì‘ì€ ê·¸ëŒ€ë¡œ ìœ ì§€í•´í•˜ëŠ” ì¦‰, ë™ì‘ì€ ë°”ê¾¸ì§€ ì•Šì€ ì±„ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒ

## ë©”ì„œë“œ ì‘ì§‘ë„

```typescript title="4ì¥ì˜ ReservationAgencyë¥¼ ë‹¤ì‹œ ë³´ì"
class ReservationAgency {
  reserve(
    screening: Screening,
    customer: Customer,
    audienceCount: number
  ): Reservation {
    const movie: Movie = screening.movie;

    let discountable: boolean = false;
    for (let condition of movie.discountCoditions) {
      if (condition.type === DiscountConditionType.PERIOD) {
        discountable =
          screening.whenScreened.getDay() === condition.dayOfWeek &&
          screening.whenScreened.getTime() >= condition.startTime &&
          screening.whenScreened.getTime() <= condition.endTime;
      } else {
        discountable = condition.sequence === screening.sequence;
      }

      if (discountable) {
        break;
      }
    }

    let fee: Money;
    if (discountable) {
      let discountAmount: Money = Money.ZERO;
      switch (movie.movieType) {
        case "AMOUNT_DISCOUNT":
          discountAmount = movie.discountAmount;
          break;
        case "PERCENT_DISCOUNT":
          discountAmount = movie.fee.times(movie.discountPercent);
          break;
        case "NONE_DISCOUNT":
          discountAmount = Money.ZERO;
          break;
      }
      fee = movie.fee.minus(discountAmount);
    } else {
      fee = movie.fee;
    }

    return new Reservation(customer, screening, fee, audienceCount);
  }
}
```

> `reserve` ë©”ì„œë“œëŠ” ë„ˆë¬´ ê¸¸ê³  ì´í•´í•˜ê¸° ì–´ë µë‹¤.

- ë©”ì„œë“œë¥¼ ì‘ê²Œ ë¶„í•´í•´ì„œ ê° ë©”ì„œë“œì˜ ì‘ì§‘ë„ë¥¼ ë†’ì—¬ë¼.

> ë©”ì„œë“œë¥¼ ì‘ê²Œ ë¶„í•´í•´ì„œ ì‘ì§‘ë„ë¥¼ ë†’ì˜€ì„ë•Œ ì¥ì 

1. ë©”ì„œë“œê°€ ì˜ê²Œ ë‚˜ëˆ ì ¸ ìˆì„ë•Œ ë‹¤ë¥¸ ë©”ì„œë“œì—ì„œ ì‚¬ìš©ë  í™•ë¥ ì´ ë†’ì•„ì§„ë‹¤.
2. ê³ ìˆ˜ì¤€ì˜ ë©”ì„œë“œë¥¼ ë³¼ ë•Œ ì¼ë ¨ì˜ ì£¼ì„ì„ ì½ëŠ” ê²ƒ ê°™ì€ ëŠë‚Œì´ ë“¤ê²Œ í•  ìˆ˜ìˆë‹¤.
3. ì˜¤ë²„ë¼ì´ë”©í•˜ëŠ” ê²ƒë„ í›¨ì”¬ ì‰½ë‹¤.
4. ì¤‘ìš”í•œê²ƒì€ ë©”ì„œë“œì˜ ì´ë¦„ê³¼ ë©”ì„œë“œ ëª¸ì²´ì˜ ì˜ë¯¸ì  ì°¨ì´ë‹¤.


