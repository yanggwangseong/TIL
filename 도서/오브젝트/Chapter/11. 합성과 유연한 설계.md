#ê°ì²´ì§€í–¥/composition-í•©ì„± 
- ìƒì†
	- ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ë¥¼ ì—°ê²°í•´ì„œ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•œë‹¤.
	- ì˜ì¡´ì„±ì€ ì»´íŒŒì¼ íƒ€ì„ì—ì„œ í•´ê²°ëœë‹¤.
	- `is-a ê´€ê³„` ë¼ê³  ë¶€ë¥¸ë‹¤.
	- ìƒì† ê´€ê³„ëŠ” í´ë˜ìŠ¤ ì‚¬ì´ì˜ ì •ì ì¸ ê´€ê³„
	- ì½”ë“œ ì‘ì„± ì‹œì ì— ê²°ì •í•œ ìƒì† ê´€ê³„ëŠ” ë³€ê²½ì´ ë¶ˆê°€ëŠ¥
	- ë¶€ëª¨ í´ë˜ìŠ¤ ì•ˆì— êµ¬í˜„ëœ ì½”ë“œ ìì²´ë¥¼ ì¬ì‚¬ìš©í•œë‹¤.
	- í´ë˜ìŠ¤ ì‚¬ì´ì˜ ë†’ì€ ê²°í•©ë„ ë°œìƒ

- í•©ì„±
	- ì „ì²´ë¥¼ í‘œí˜„í•˜ëŠ” ê°ì²´ê°€ ë¶€ë¶„ì„ í‘œí˜„í•˜ëŠ” ê°ì²´ë¥¼ í¬í•¨í•´ì„œ ë¶€ë¶„ ê°ì²´ì˜ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•œë‹¤.
	- ë‘ ê°ì²´ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì€ ëŸ°íƒ€ì„ì— í•´ê²°ëœë‹¤.
	- `has-a ê´€ê³„` ë¼ê³  ë¶€ë¥¸ë‹¤.
	- ê°ì²´ ì‚¬ì´ì˜ ë™ì ì¸ ê´€ê³„
	- ì‹¤í–‰ ì‹œì ì— ë™ì ìœ¼ë¡œ ë³€ê²½ í•  ìˆ˜ ìˆë‹¤.
	- í¬í•¨ë˜ëŠ” ê°ì²´ì˜ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¬ì‚¬ìš© í•œë‹¤. êµ¬í˜„ì— ëŒ€í•œ ì˜ì¡´ì„±ì„ ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ ì˜ì¡´ì„±ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
	- í´ë˜ìŠ¤ ì‚¬ì´ì˜ ë†’ì€ ê²°í•©ë„ë¥¼ ê°ì²´ ì‚¬ì´ì˜ ë‚®ì€ ê²°í•©ë„ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.

> *í•©ì„±* ì€ êµ¬í˜„ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤. ë‚´ë¶€ì— í¬í•¨ë˜ëŠ” ê°ì²´ì˜ êµ¬í˜„ì´ ì•„ë‹Œ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ë¯€ë¡œ êµ¬í˜„ì´ ë³€ê²½ë˜ë”ë¼ë„ ì˜í–¥ì„ ìµœì†Œí™” í•  ìˆ˜ ìˆë‹¤.

![](../images/image07.png)
# ğŸŠ ìƒì†ì„ í•©ì„±ìœ¼ë¡œ ë³€ê²½í•˜ê¸°
> ìƒì†ì„ ë‚¨ìš© í–ˆì„ ë•Œ ìƒê¸¸ ìˆ˜ ìˆëŠ” ì„¸ê°€ì§€ ë¬¸ì œ

- [0] ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ ìƒì† ë¬¸ì œ


```java title="Propertiesë¥¼ í•©ì„± ê´€ê³„ë¡œ ë³€ê²½"
public class Properties {
	private Hashtable<String, String> properties = new Hashtable <>();

	public String setProperty(String key, String value){
		return properties.put(key, value);
	}

	public String getProperty(String key){
		return properties.get(key);
	}
}
```

- í•©ì„± ê´€ê³„ë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ `Properties` í´ë˜ìŠ¤ì—ì„œ ìƒì† ê´€ê³„ë¥¼ ì œê±°í•˜ê³  `Hashtable` ì„ `Properties` ì˜ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ í¬í•¨ ì‹œí‚¤ë©´ í•©ì„± ê´€ê³„ë¡œ ë³€ê²½ í•  ìˆ˜ ìˆë‹¤.

- [1] ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë”©ì˜ ì˜¤ì‘ìš© ë¬¸ì œ

```java title="InstrunmentedHashSetë¥¼ í•©ì„± ê´€ê³„ë¡œ ë³€ê²½"
public class InstrunmentedHashSet<E>{
	private int addCount = 0;
	private Set<E> = set;

	public InstrunmentedHashSet(Set<E> set) {
		this.set = set;
	}

	public boolean add(E e){
		addCount++;
		return set.add(e);
	}

	public boolean addAll(Collection<? extends E> c){
		addCount += c.size();
		return set.addAll(c);
	}

	public int getAddCount(){
		return addCount;
	}
}
```

- ìœ„ì˜ `Properties` ë¥¼ í•©ì„±ìœ¼ë¡œ ë³€ê²½í•œ ì´ìœ ëŠ” ë¶ˆí•„ìš”í•œ ì˜¤í¼ë ˆì´ì…˜ë“¤ì´ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ìŠ¤ë©°ë“œëŠ”ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œê³ 
- `InstrumentedHashSet` ì˜ ê²½ìš°ì— `HashSet` ì´ ì œê³µí•˜ëŠ” í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì œê³µí•´ì•¼ í•œë‹¤.
- `InstrumentedHashSet` ì´ `Set` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‹¤ì²´í™”í•˜ë©´ì„œ ë‚´ë¶€ì— `HashSet` ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•©ì„±í•˜ë©´ `HashSet` ì— ëŒ€í•œ êµ¬í˜„ ê²°í•©ë„ëŠ” ì œê±°í•˜ë©´ì„œ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.


- [2] ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ì˜ ë™ì‹œ ìˆ˜ì • ë¬¸ì œ

```java
public class PersonalPlaylist{
	private Playlist playlist = new Playlist();

	public void append(Song song){
		playlist.append(song);
	}

	public void remove(Song song){
		playlist.getTracks().remove(song);
		playlist.getSingers().remove(song.getSinger());
	}
}
```

- `Playlist` ì˜ ê²½ìš°ì—ëŠ” í•©ì„±ìœ¼ë¡œ ë³€ê²½í•˜ë”ë¼ë„ í•¨ê»˜ ìˆ˜ì •ë˜ëŠ” ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤.
- ê·¸ë˜ë„ *ìƒì†ë³´ë‹¤ í•©ì„±ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ë” ì¢‹ë‹¤* 
	- í–¥í›„ `Playlist` ì˜ ë‚´ë¶€ êµ¬í˜„ì„ ë³€ê²½í•˜ë”ë¼ë„ íŒŒê¸‰íš¨ê³¼ë¥¼ ìµœëŒ€í•œ `PersonalPlaylist` ë‚´ë¶€ë¡œ ìº¡ìŠí™” í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
- **êµ¬í˜„ì— ëŒ€í•œ ê²°í•©ë³´ë‹¤(ìƒì†) ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ ê²°í•©(í•©ì„±)ì´ ë” ì¢‹ë‹¤**

## ê²°ë¡ 
- í•©ì„±ì„ ì‚¬ìš©í•˜ë©´ ìœ„ì˜ ì„¸ê°€ì§€ ë¬¸ì œë¥¼ í•´ê²° í•  ìˆ˜ ìˆë‹¤.
- ìƒì†ì„ í•©ì„±ìœ¼ë¡œ ë°”ê¾¸ëŠ” ë°©ë²•ì€ ìì‹ í´ë˜ìŠ¤ì— ì„ ì–¸ëœ ìƒì† ê´€ê³„ë¥¼ ì œê±°í•˜ê³  ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìì‹ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ë©´ ëœë‹¤.


# ğŸ‰ ìƒì†ìœ¼ë¡œ ì¸í•œ ì¡°í•©ì˜ í­ë°œì ì¸ ì¦ê°€
> ìƒì†ìœ¼ë¡œ ì¸í•´ ê²°í•©ë„ê°€ ë†’ì•„ì§€ë©´ ìƒê¸¸ ìˆ˜ ìˆëŠ” ë¬¸ì œ

- í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•˜ê²Œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•´ì•¼ í•œë‹¤.
- ë‹¨ì¼ ìƒì†ë§Œ ì§€ì›í•˜ëŠ” ì–¸ì–´ì—ì„œëŠ” ì˜¤íˆë ¤ ì¤‘ë³µ ì½”ë“œì˜ ì–‘ì´ ëŠ˜ì–´ë‚  ìˆ˜ ìˆë‹¤.

`í•©ì„±` ì„ ì‚¬ìš©í•˜ë©´ ì´ì™€ ê°™ì€ ë¬¸ì œë“¤ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

## ê¸°ë³¸ ì •ì±…ê³¼ ë¶€ê°€ ì •ì±… ì¡°í•©í•˜ê¸°
> 10ì¥ì˜ 'í•¸ë“œí° ê³¼ê¸ˆ ì‹œìŠ¤í…œ'ì„ ì˜ˆì‹œë¡œ ì‚¬ìš©

- ê¸°ë³¸ ì •ì±…
	- ì¼ë°˜ ìš”ê¸ˆì œ
	- ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ
- ë¶€ê°€ ì •ì±…
	- ì„¸ê¸ˆ ì •ì±…
	- ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…

> ì˜ˆì‹œë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ ë¶€ê°€ ì •ì±…ì˜ íŠ¹ì„±

- ê¸°ë³¸ ì •ì±…ì˜ ê³„ì‚° ê²°ê³¼ì— ì ìš©ëœë‹¤.
	- ì„¸ê¸ˆ ì •ì±…ì€ ê¸°ë³¸ ì •ì±…ì¸ `RegularPhone` ì´ë‚˜ `NgightlyDiscountPhone` ì˜ ê³„ì‚°ì´ ëë‚œ ê²°ê³¼ì— ì„¸ê¸ˆì„ ë¶€ê³¼í•œë‹¤.
- ì„ íƒì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.
	- ê¸°ë³¸ ì •ì±…ì˜ ê³„ì‚° ê²°ê³¼ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ë„ ìˆê³  ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ë„ ìˆë‹¤.
- ì¡°í•© ê°€ëŠ¥í•˜ë‹¤
	- ê¸°ë³¸ ì •ì±…ì— ì„¸ê¸ˆ ì •ì±…ë§Œ ì ìš©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ê³ , ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ë§Œ ì ìš©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.
	- ì„¸ê¸ˆ ì •ì±…ê³¼ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ í•¨ê»˜ ì ìš© í•˜ëŠ”ê²ƒë„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.
- ë¶€ê°€ ì •ì±…ì€ ì„ì˜ì˜ ìˆœì„œë¡œ ì ìš© ê°€ëŠ¥í•˜ë‹¤
	- ê¸°ë³¸ ì •ì±…ì— ì„¸ê¸ˆ ì •ì±…ê³¼ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ í•¨ê»˜ ì ìš© í•  ê²½ìš° ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•œ í›„ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë„ ìˆê³ , ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•œ í›„ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ë„ ìˆë‹¤.

![](../images/image08.png)

> ê¸°ë³¸ ì •ì±…ê³¼ ë¶€ê°€ ì •ì±…ì„ ì¡°í•©í•´ì„œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ëª¨ë“  ìš”ê¸ˆ ì •ì±…ì˜ ì¢…ë¥˜ì˜ ê·¸ë¦¼


## ìƒì†ì„ ì´ìš©í•´ì„œ ê¸°ë³¸ ì •ì±… êµ¬í˜„í•˜ê¸°

```typescript title="10ì¥ ì˜ˆì œì½”ë“œ"
class Call {
  private from: Date;
  private to: Date;
  constructor(from: Date, to: Date) {
    this.from = from;
    this.to = to;
  }

  public get Duration(): number {
    return (this.to.getTime() - this.from.getTime()) / 1000;
  }

  public get From(): Date {
    return this.from;
  }
}

abstract class Phone {
  private calls: Call[] = [];

  public calculateFee(): Money {
    let result = Money.ZERO;

    for (const call of this.calls) {
      result = result.plus(this.calculateCallFee(call));
    }

    return result;
  }

  protected abstract calculateCallFee(call: Call): Money;
}

class RegularPhone extends Phone {
  private amount: Money;
  private seconds: number;

  constructor(amount: Money, seconds: number) {
    super();
    this.amount = amount;
    this.seconds = seconds;
  }

  protected override calculateCallFee(call: Call): Money {
    return this.amount.times(call.Duration / this.seconds);
  }
}

class NightlyDiscountPhone extends Phone {
  private static LATE_NIGHT_HOUR: number = 22;

  private nightlyAmount: Money;
  private regularAmount: Money;
  private seconds: number;

  constructor(nightlyAmount: Money, regularAmount: Money, seconds: number) {
    super();
    this.nightlyAmount = nightlyAmount;
    this.regularAmount = regularAmount;
    this.seconds = seconds;
  }

  protected override calculateCallFee(call: Call): Money {
    if (call.From.getHours() >= NightlyDiscountPhone.LATE_NIGHT_HOUR) {
      return this.nightlyAmount.times(call.Duration / this.seconds);
    }
    return this.regularAmount.times(call.Duration / this.seconds);
  }
}
```

## ê¸°ë³¸ ì •ì±…ì— ì„¸ê¸ˆ ì •ì±… ì¡°í•©í•˜ê¸°
> ì¼ë°˜ ìš”ê¸ˆì œì— ì„¸ê¸ˆ ì •ì±…ì„ ì¡°í•©
> > RegularPhoneí´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì€ TaxableRegularPhone í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ”ê²ƒ

```typescript title="TaxableRegularPhone í´ë˜ìŠ¤ "
class TaxableRegularPhone extends RegularPhone {
  private taxRate: number;

  constructor(amount: Money, seconds: number, taxRate: number) {
    super(amount, seconds);
    this.taxRate = taxRate;
  }

  protected override calculateCallFee(call: Call): Money {
    const fee = super.calculateFee();
    return fee.plus(fee.times(this.taxRate));
  }
  
}
```

> ë¶€ëª¨ì˜ ê²°ê³¼ê°’ `{ts icon title:"ë¶€ëª¨ì˜ calculateFee ê²°ê³¼"}const fee = super.calculateFee();` 
> ë¥¼ ë°›ì•„ì„œ taxRateë¥¼ ê³„ì‚° í•´ì¤€ë‹¤.

- ìì‹ í´ë˜ìŠ¤ì™€ ë¶€ëª¨ í´ë˜ìŠ¤ ì‚¬ì´ì˜ ê²°í•©ë„ê°€ ë†’ì•„ì§„ë‹¤.
	- *ê²°í•©ë„ë¥¼ ë‚®ì¶”ë ¤ë©´ ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šë„ë¡ ë¶€ëª¨ í´ë˜ìŠ¤ì— ì¶”ìƒ ë©”ì„œë“œë¥¼ ì œê³µ í•œë‹¤.* 

```ts title="Phone ì¶”ìƒ í´ë˜ìŠ¤" hl:15
abstract class Phone {
  private calls: Call[] = [];

  public calculateFee(): Money {
    let result = Money.ZERO;

    for (const call of this.calls) {
      result = result.plus(this.calculateCallFee(call));
    }

    return result;
  }

  protected abstract calculateCallFee(call: Call): Money;
  protected abstract afterCalculated(fee: Money): Money;
}
```

```typescript title="RegularPhone ìˆ˜ì •" hl:15-17
class RegularPhone extends Phone {
  private amount: Money;
  private seconds: number;

  constructor(amount: Money, seconds: number) {
    super();
    this.amount = amount;
    this.seconds = seconds;
  }

  protected override calculateCallFee(call: Call): Money {
    return this.amount.times(call.Duration / this.seconds);
  }
  
  protected override afterCalculated(fee: Money) {
    return fee;
  }
}
```

```ts title="NightlyDiscountPhone ìˆ˜ì •" hl:22-24
class NightlyDiscountPhone extends Phone {
  private static LATE_NIGHT_HOUR: number = 22;

  private nightlyAmount: Money;
  private regularAmount: Money;
  private seconds: number;

  constructor(nightlyAmount: Money, regularAmount: Money, seconds: number) {
    super();
    this.nightlyAmount = nightlyAmount;
    this.regularAmount = regularAmount;
    this.seconds = seconds;
  }

  protected override calculateCallFee(call: Call): Money {
    if (call.From.getHours() >= NightlyDiscountPhone.LATE_NIGHT_HOUR) {
      return this.nightlyAmount.times(call.Duration / this.seconds);
    }
    return this.regularAmount.times(call.Duration / this.seconds);
  }

  protected override afterCalculated(fee: Money) {
    return fee;
  }
}
```

> ìœ„ ì½”ë“œì—ì„œì˜ ë¬¸ì œì 

- *ë¶€ëª¨ í´ë˜ìŠ¤ì— ì¶”ìƒ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ë©´ ëª¨ë“  ìì‹ í´ë˜ìŠ¤ë“¤ì´ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤* 
- ëª¨ë“  ì¶”ìƒ ë©”ì„œë“œì˜ êµ¬í˜„ì´ ë™ì¼ í•˜ë‹¤.


```typescript title="ìœ ì—°ì„±ì€ ìœ ì§€í•˜ë©´ì„œ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•"
abstract class Phone {
  private calls: Call[] = [];

  protected afterCalculated(fee: Money): Money {
    return fee;
  }

  public calculateFee(): Money {
    let result = Money.ZERO;

    for (const call of this.calls) {
      result = result.plus(this.calculateCallFee(call));
    }

    return result;
  }

  protected abstract calculateCallFee(call: Call): Money;
}
```

> ìœ ì—°ì„±ì€ ìœ ì§€í•˜ë©´ì„œ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•
> ì´ì œ `RegularPhone` ê³¼ `NightlyDiscountPhone` í´ë˜ìŠ¤ì—ì„œ `afterCalculated` ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•  í•„ìš”ê°€ ì—†ë‹¤.


## ì¶”ìƒ ë©”ì„œë“œì™€ í›… ë©”ì„œë“œ
#ê°ì²´ì§€í–¥/ì¶”ìƒë©”ì„œë“œì™€í›…ë©”ì„œë“œ
- ê°œë°©-íì‡„ ì›ì¹™ì„ ë§Œì¡±í•˜ëŠ” ì„¤ê³„ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì€ í•œê°€ì§€ë¡œ ë¶€ëª¨ í´ë˜ìŠ¤ì— ìƒˆë¡œìš´ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ê³  ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë‹¤ë¥¸ ë©”ì„œë“œ ì•ˆì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ë‹¤.
	- ìì‹ í´ë˜ìŠ¤ëŠ” ì¶”ìƒ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•¨.
- *ì¶”ìƒ ë©”ì„œë“œì˜ ë‹¨ì *  : ìƒì† ê³„ì¸µì— ì†í•˜ëŠ” **ëª¨ë“  ìì‹ í´ë˜ìŠ¤ê°€ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©** í•´ì•¼ í•œë‹¤.
- *í›… ë©”ì„œë“œ(hook method)* : ìì‹ í´ë˜ìŠ¤ê°€ ì¶”ìƒ ë©”ì„œë“œë¥¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ í–ˆì„ë•Œ ì¤‘ë³µ ì½”ë“œê°€ ì¡´ì¬í•˜ê²Œ ë˜ëŠ”ë° ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì¶”ìƒ ë©”ì„œë“œì™€ ë™ì¼í•˜ê²Œ ìì‹ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë”©í•  ì˜ë„ë¡œ ë©”ì„œë“œë¥¼ ì¶”ê°€ í–ˆì§€ë§Œ í¸ì˜ë¥¼ ìœ„í•´ ê¸°ë³¸ êµ¬í˜„ì„ ì œê³µí•˜ëŠ” ë©”ì„œë“œ.

```typescript title="ì¼ë°˜ ìš”ê¸ˆì œ ì„¸ê¸ˆ ì •ì±…ê³¼ ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆ ì„¸ê¸ˆ ì •ì±…"
class TaxableRegularPhone extends RegularPhone {
  private taxRate: number;

  constructor(amount: Money, seconds: number, taxRate: number) {
    super(amount, seconds);
    this.taxRate = taxRate;
  }

  // protected override calculateCallFee(call: Call): Money {
  //   const fee = super.calculateFee();
  //   return fee.plus(fee.times(this.taxRate));
  // }

  protected override afterCalculated(fee: Money): Money {
    return fee.plus(fee.times(this.taxRate));
  }
}
// ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œì˜ ì„¸ê¸ˆ ë¶€ê³¼
class TaxableNightlyDiscountPhone extends NightlyDiscountPhone {
  private taxRate: number;

  constructor(
    nightlyAmount: Money,
    regularAmount: Money,
    seconds: number,
    taxRate: number
  ) {
    super(nightlyAmount, regularAmount, seconds);
    this.taxRate = taxRate;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.plus(fee.times(this.taxRate));
  }
}
```


### ì‚¬ìš©
```ts
...

// ì¼ë°˜ ìš”ê¸ˆì œ ë‹¨ë… ì‚¬ìš©
const regularPhone = new RegularPhone(Money.wons(10), 10);

// ì¼ë°˜ ìš”ê¸ˆì œ + ì„¸ê¸ˆ ì ìš©
const taxableRegularPhone = new TaxableRegularPhone(Money.wons(10), 10, 0.05);

// ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ ë‹¨ë… ì‚¬ìš©
const nightlyDiscountPhone = new NightlyDiscountPhone(
  Money.wons(5),
  Money.wons(10),
  10
);

// ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ + ì„¸ê¸ˆ ì ìš©
const taxableNightlyDiscountPhone = new TaxableNightlyDiscountPhone(
  Money.wons(5),
  Money.wons(10),
  10,
  0.05
);
```

> ë¬¸ì œ
> `TaxableNightlyDiscountPhone` ê³¼ `TaxableRegularPhone` ì‚¬ì´ì— ì½”ë“œë¥¼ ì¤‘ë³µí–ˆë‹¤ëŠ” ê²ƒì´ë‹¤.
> ë³´í†µ ê°ì²´ì§€í–¥ ì–¸ì–´ëŠ” ë‹¨ì¼ ìƒì†ë§Œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— *ìƒì†ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì¤‘ë³µ ì½”ë“œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ê°€ ì‰½ì§€ ì•Šë‹¤.* 


## ê¸°ë³¸ ì •ì±…ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±… ì¡°í•©í•˜ê¸°
> ë‘ë²ˆì§¸ ë¶€ê°€ ì •ì±… ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±… ì¶”ê°€


> ì¼ë°˜ ìš”ê¸ˆì œì™€ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…

```ts title="ì¼ë°˜ ìš”ê¸ˆì œì™€ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…"
class RateDiscountableRegularPhone extends RegularPhone {
  private discountAmount: Money;

  constructor(amount: Money, seconds: number, discountAmount: Money) {
    super(amount, seconds);
    this.discountAmount = discountAmount;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.minus(this.discountAmount);
  }
}
```

> ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œì™€ ê¸°ë³¸ í• ì¸ ì •ì±…

```ts title="ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œì™€ ê¸°ë³¸ í• ì¸ ì •ì±…"
class RateDiscountableNightlyDiscountPhone extends NightlyDiscountPhone {
  private discountAmount: Money;

  constructor(
    nightlyAmount: Money,
    regularAmount: Money,
    seconds: number,
    discountAmount: Money
  ) {
    super(nightlyAmount, regularAmount, seconds);
    this.discountAmount = discountAmount;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.minus(this.discountAmount);
  }
}
```


## ì¤‘ë³µ ì½”ë“œì˜ ë«ì— ê±¸ë¦¬ë‹¤
> ë¶€ê°€ ì •ì±…ì„ êµ¬í˜„í•œ `RateDiscountableRegularPhone` í´ë˜ìŠ¤ì™€ `RateDiscountableNightlyDiscountPhone` í´ë˜ìŠ¤ ì‚¬ì´ì— ì¤‘ë³µ ì½”ë“œë¡œ ì¸í•´ ì´ˆë˜í•˜ëŠ” ë¬¸ì œ

1. ë¶€ê°€ ì •ì±…ì€ ììœ ë¡­ê²Œ ì¡°í•©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
	- ì„¸ê¸ˆ ì •ì±…ê³¼ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ í•¨ê»˜ ì ìš©í•˜ëŠ”ê²ƒë„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.
2. ë¶€ê°€ ì •ì±…ì€ ì ìš© ìˆœì„œ ì—­ì‹œ ì„ì˜ë¡œ ê²°ì • í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
	- ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•œ í›„ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•˜ê±°ë‚˜ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•œ í›„ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•˜ëŠ”ê²ƒë„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.

> ìƒì†ìœ¼ë¡œ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ëª¨ë“  ê°€ëŠ¥í•œ ì¡°í•©ë³„ë¡œ ìì‹ í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ì”© ì¶”ê°€í•˜ëŠ”ê²ƒì´ë‹¤.

```typescript

/**
 * ì¼ë°˜ ìš”ê¸ˆì œì˜ ê³„ì‚° ê²°ê³¼ì— ì„¸ê¸ˆ ì •ì±…ì„ ì¡°í•©í•œ í›„ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì¶”ê°€
 */
class TaableAndRateDiscountableRegularPhone extends TaxableRegularPhone {
  private discountAmount: Money;

  constructor(
    amount: Money,
    seconds: number,
    taxRate: number,
    discountAmount: Money
  ) {
    super(amount, seconds, taxRate);
    this.discountAmount = discountAmount;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.minus(this.discountAmount);
  }
}
```

```typescript
/**
 * í‘œì¤€ ìš”ê¸ˆì œì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ë¨¼ì € ì ìš©í•œ í›„ ì„¸ê¸ˆì„ ë‚˜ì¤‘ì— ë¶€ê³¼
 */
class RateDiscountableAndTaxableRegularPhone extends RateDiscountableRegularPhone {
  private taxRate: number;

  constructor(
    amount: Money,
    seconds: number,
    discountAmount: Money,
    taxRate: number
  ) {
    super(amount, seconds, discountAmount);
    this.taxRate = taxRate;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.plus(fee.times(this.taxRate));
  }
}
```

```typescript
/**
 *ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œì˜ ê³„ì‚° ê²°ê³¼ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•œ í›„ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©
 */
class TaxableAndDiscountableNightlyDiscountPhone extends TaxableNightlyDiscountPhone {
  private discountAmount: Money;

  constructor(
    nightlyAmount: Money,
    regularAmount: Money,
    seconds: number,
    taxRate: number,
    discountAmount: Money
  ) {
    super(nightlyAmount, regularAmount, seconds, taxRate);
    this.discountAmount = discountAmount;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.minus(this.discountAmount);
  }
}
```

```typescript
/**
 * ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œì˜ ê³„ì‚° ê²°ê³¼ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•œ í›„ ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©
 */
class RateDiscountableAndTaxableNightlyDiscountPhone extends RateDiscountableNightlyDiscountPhone {
  private taxRate: number;

  constructor(
    nightlyAmount: Money,
    regularAmount: Money,
    seconds: number,
    discountAmount: Money,
    taxRate: number
  ) {
    super(nightlyAmount, regularAmount, seconds, discountAmount);
    this.taxRate = taxRate;
  }

  protected override afterCalculated(fee: Money): Money {
    return fee.plus(fee.times(this.taxRate));
  }
}
```

![](../images/image09.png)

![](../images/image10.png)
### ë¬¸ì œ ë°œìƒ
- ìƒˆë¡œìš´ ì •ì±…ì„ ì¶”ê°€í•˜ê¸°ê°€ ì–´ë µë‹¤.
- ìƒˆë¡œìš´  ê¸°ë³¸ ì •ì±…ìœ¼ë¡œ `FixedRatePhone` ê³ ì • ìš”ê¸ˆì œë¥¼ ì¶”ê°€ í•œë‹¤ê³  ê°€ì •
	- ëª¨ë“  ë¶€ê°€ ì •ì±…ì€ ê¸°ë³¸ ì •ì±…ì— ì ìš© ê°€ëŠ¥í•´ì•¼ í•˜ë©° ì¡°í•© ìˆœì„œ ì—­ì‹œ ììœ ë¡œì›Œì•¼ í•œë‹¤.
	- ìƒˆë¡œìš´ ê¸°ë³¸ ì •ì±…ì„ ì¶”ê°€í•˜ë©´ ê·¸ì— ë”°ë¼ ì¡°í•© ê°€ëŠ¥í•œ ë¶€ê°€ ì •ì±…ì˜ ìˆ˜ë§Œí¼ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€ í•´ì•¼í•¨.
- ìƒˆë¡œìš´ ë¶€ê°€ ì •ì±…ì„ ì¶”ê°€í•˜ëŠ” ê²½ìš°
	- ê°œí†µ í›„ ì¼ì • ê¸°ê°„ ë™ì•ˆ ìš”ê¸ˆ ì¼ë¶€ë¥¼ í• ì¸í•´ ì£¼ëŠ” 'ì•½ì • í• ì¸ ì •ì±…' ì¶”ê°€ í•œë‹¤ê³  ê°€ì •
		- ë¬¸ì œëŠ” `RegularPhone` , `NightlyDiscountPhone` , `FixedRatePhone` ì•½ì • í• ì¸ ì •ì±…ì„ ì„ íƒì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
		- ë˜í•œ ë‹¤ë¥¸ ë¶€ê°€ ì •ì±… ì„¸ê¸ˆ ì •ì±…, ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ê³¼ë„ ì„ì˜ ìˆœì„œë¡œ ì¡°í•© ê°€ëŠ¥ í•´ì•¼ í•œë‹¤.
		- ì¦‰, ì—„ì²­ë‚œ ê°¯ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€ í•´ì•¼í•¨ ì´ë¥¼ í´ë˜ìŠ¤ í­ë°œì´ë¼ê³  í•¨ 
- í´ë˜ìŠ¤ í­ë°œ(class explosion) : ìƒì†ì˜ ë‚¨ìš©ìœ¼ë¡œ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ í•„ìš” ì´ìƒìœ¼ë¡œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€ í•´ì•¼ í•˜ëŠ” ê²½ìš°ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
- *ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ì˜ ë‹¤ì–‘í•œ ì¡°í•©ì´ í•„ìš”í•œ ìƒí™©ì—ì„œ ìœ ì¼í•œ í•´ê²° ë°©ë²•ì€ ì¡°í•©ì˜ ìˆ˜ë§Œí¼ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ”ê²ƒ ë¿ì´ë‹¤* 
- í´ë˜ìŠ¤ í­ë°œ ë¬¸ì œëŠ” ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ë•Œ ë¿ë§Œ ì•„ë‹ˆë¼ ìˆ˜ì •í• ë•Œë„ ë¬¸ì œê°€ ëœë‹¤.

